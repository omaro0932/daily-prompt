<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DailyPrompt</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --bg1:#6c5ce7;--bg2:#a29bfe;--text:#fff;--card-bg:rgba(255,255,255,0.15);--accent:#fd79a8;--secondary:#ffeaa7;--shadow:rgba(0,0,0,0.25);}
    body.dark { --bg1:#1e1f26;--bg2:#2d3038;--text:#fff;--card-bg:rgba(255,255,255,0.07);--accent:#ff6b81;--secondary:#dfe6e9;--shadow:rgba(0,0,0,0.5);}
    body { margin:0;font-family:'Inter',sans-serif;background:linear-gradient(145deg,var(--bg1),var(--bg2));color:var(--text);display:flex;flex-direction:column;align-items:center;padding:25px;min-height:100vh;text-align:center;transition:background 0.4s ease;}
    h1 { font-size:2.7em;margin:15px 0 10px 0;font-weight:700;text-shadow:0 3px 10px var(--shadow);}
    #prompt { background:var(--card-bg);backdrop-filter:blur(10px);margin-top:20px;padding:22px;border-radius:18px;width:90%;max-width:400px;min-height:110px;display:flex;align-items:center;justify-content:center;font-size:1.3em;line-height:1.4em;box-shadow:0 6px 20px var(--shadow);animation:fadeIn 0.4s ease;}
    @keyframes fadeIn { from{opacity:0;transform:translateY(10px);} to{opacity:1;transform:translateY(0);} }
    .btn { margin-top:15px;width:90%;max-width:350px;padding:15px;border:none;border-radius:14px;font-size:1.1em;font-weight:600;background:var(--accent);color:#fff;cursor:pointer;box-shadow:0 4px 12px var(--shadow);transition:transform 0.2s, box-shadow 0.2s;}
    .btn:hover { transform:translateY(-3px);box-shadow:0 6px 16px var(--shadow);}
    #streak { margin-top:20px;font-size:1.2em;font-weight:600;text-shadow:0 2px 8px var(--shadow);}
    #particles { position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}
  </style>
</head>
<body>

<div id="particles"></div>
<h1>DailyPrompt</h1>
<div id="prompt">Tap "Surprise Me!" to receive your creative prompt</div>
<button id="surpriseBtn" class="btn">üé≤ Surprise Me!</button>
<button id="shareBtn" class="btn">üì§ Share Prompt</button>
<button id="themeBtn" class="btn">üåó Toggle Theme</button>
<div id="streak">Your streak: 0 days</div>

<script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.1/tsparticles.bundle.min.js"></script>
<script>
  tsParticles.load("particles",{particles:{number:{value:45},size:{value:3},move:{speed:1},links:{enable:true,distance:130},color:{value:["#fd79a8","#6C5CE7","#FFEAA7"]}}});
  
  const prompts=["Write a story in one sentence.","Describe your day using only emojis.","Invent a new holiday and explain it.","Write a haiku about your mood.","Create a motivational quote.","Describe a scene from a movie that doesn't exist.","Explain a random fact you love.","Write a 3-word horror story.","Describe a color without naming it.","Invent a new superpower."];
  const promptEl=document.getElementById("prompt");
  const streakEl=document.getElementById("streak");
  
  // Use in-memory storage instead of localStorage (not supported in Farcaster frames)
  let streak = 0;
  let lastDate = null;
  
  function updateStreak(){
    const today=new Date().toISOString().slice(0,10);
    if(lastDate!==today){
      streak++;
      lastDate=today;
    }
    streakEl.innerText=`Your streak: ${streak} days`;
  }
  
  updateStreak();
  
  document.getElementById("surpriseBtn").onclick=()=>{
    const random=prompts[Math.floor(Math.random()*prompts.length)];
    promptEl.style.opacity=0;
    setTimeout(()=>{
      promptEl.innerText=random;
      promptEl.style.opacity=1;
    },200);
    updateStreak();
document.getElementById("shareBtn").onclick = () => {
  window.location.href = `/api/share?text=${encodeURIComponent(promptEl.innerText)}`;
};

  const themeBtn=document.getElementById("themeBtn");
  themeBtn.onclick=()=>{
    document.body.classList.toggle("dark");
  };
</script>

<!-- Farcaster SDK -->
<script src="https://cdn.jsdelivr.net/npm/@farcaster/frame-sdk/dist/index.min.js"></script>
<script>
  // Wait for SDK to be fully loaded
  function initSDK() {
    if (window.frame?.sdk?.actions?.ready) {
      try {
        window.frame.sdk.actions.ready();
        console.log("‚úÖ SDK ready called - splash screen should hide");
      } catch (err) {
        console.error("‚ùå Error calling sdk.actions.ready():", err);
      }
    } else {
      console.log("‚è≥ SDK not ready yet, retrying...");
      setTimeout(initSDK, 100);
    }
  }

  // Start trying to initialize once DOM is loaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSDK);
  } else {
    initSDK();
  }
</script>

</body>
</html>

